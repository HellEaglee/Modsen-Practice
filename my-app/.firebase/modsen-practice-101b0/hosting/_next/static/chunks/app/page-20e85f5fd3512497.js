(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4597:function(e,t,l){Promise.resolve().then(l.bind(l,5521))},5521:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return J}});var s=l(7437),a=l(2265),r=l(1444),n=l(7744),i=l(9753);let c=(0,i.oM)({name:"currentCoordinates",initialState:{currentCoordinates:{lat:0,lng:0}},reducers:{setCurrentCoordinates(e,t){e.currentCoordinates=t.payload}}}),{setCurrentCoordinates:o}=c.actions;var d=c.reducer,u=l(8012),p=l(5097),h=l(7312),x=l(6502),g=l(9550),m=l(2202),f=l(6525),v=l(1881),b=l(5367);let j=[{type:"tourist_attraction",icon:h.default,label:"Архитектура"},{type:"park",icon:x.default,label:"Природа"},{type:"art_gallery",icon:g.default,label:"Культура"},{type:"museum",icon:m.default,label:"История"},{type:"church",icon:f.default,label:"Религия"},{type:"restaurant",icon:v.default,label:"Рестораны"},{type:"lodging",icon:b.default,label:"Отели"}],y="https://explorelompoc.com/wp-content/uploads/2021/06/food_placeholder.jpg",w=()=>{let e=(0,r.I0)(),t=(0,r.v9)(e=>e.places.places),[l,n]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e=setTimeout(()=>{n(!1)},500);return()=>clearTimeout(e)},[e]),l&&0===t.length)?(0,s.jsx)("div",{className:"h-screen z-10 overflow-hidden bg-white bg-opacity-90 px-2 flex flex-col",children:Array.from({length:5}).map((e,t)=>(0,s.jsxs)("div",{className:"p-6 mt-3 bg-white shadow-lg",children:[(0,s.jsx)("div",{className:"h-24 w-24 bg-gray-300 rounded-full animate-pulse"}),(0,s.jsx)("div",{className:"mt-4 space-y-4",children:Array.from({length:3}).map((e,t)=>(0,s.jsx)("div",{className:"h-4 bg-gray-300 rounded animate-pulse"},t))})]},t))}):(0,s.jsx)("div",{className:"mt-3  flex flex-col gap-4 overflow-y-scroll max-h-[85vh]",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"p-6 mt-3 bg-white shadow-lg",children:[(0,s.jsx)("img",{src:e.photos&&e.photos.length>0?e.photos[0].getUrl():y,alt:"",className:"size-24 rounded"}),(0,s.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,s.jsx)("h2",{children:e.name}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(u.Z,{size:"small",value:Number(e.rating),readOnly:!0}),(0,s.jsx)("p",{children:e.user_ratings_total})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(p.D49,{fontSize:20,className:"text-gray-500"}),(0,s.jsx)("p",{children:e.vicinity})]})]})]},t))})},N=(0,i.oM)({name:"type",initialState:{type:"tourist_attraction"},reducers:{setType(e,t){e.type=t.payload}}}),{setType:C}=N.actions;var _=N.reducer;let S=(0,i.oM)({name:"range",initialState:{range:1800},reducers:{setRange(e,t){e.range=t.payload}}}),{setRange:k}=S.actions;var I=S.reducer;let E=()=>{let e=(0,r.I0)(),t=(0,r.v9)(e=>e.range.range),l=(0,r.v9)(e=>e.type.type),[n,i]=(0,a.useState)("");return(0,a.useEffect)(()=>{i(l)},[l]),(0,s.jsxs)("div",{className:"flex flex-col justify-between mt-[35px]",children:[(0,s.jsx)("h1",{className:"text-[20px] font-extrabold mb-[15px]",children:"Искать:"}),(0,s.jsx)("div",{className:"flex flex-col w-[350px] h-[390px] border-2 border-black rounded-lg p-5 gap-5 mb-7",children:j.map(t=>(0,s.jsxs)("div",{className:"flex items-center gap-5 cursor-pointer",onClick:()=>e(C(t.type)),children:[(0,s.jsx)("img",{src:t.icon.src,alt:t.label,className:"w-8 h-8"}),(0,s.jsx)("p",{className:"text-sm font-bold ".concat(n===t.type?"text-black":"text-gray-500"),children:t.label})]},t.type))}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("h1",{className:"text-[20px] font-extrabold mr-[15px]",children:"В радиусе:"}),(0,s.jsx)("input",{type:"number",value:t,readOnly:!0,disabled:!0,className:"flex items-center bg-white text-[18px] font-bold w-[100px]"})]}),(0,s.jsx)("input",{type:"range",min:500,max:3e3,step:100,className:"flex w-[350px] items-center",onChange:t=>{e(k(Number(t.target.value)))}})]})]})},R=()=>(0,s.jsx)("div",{className:"flex flex-col justify-between mt-[35px]",children:(0,s.jsx)("h1",{className:"text-[20px] font-extrabold mb-[15px]",children:"Избранное"})}),P=()=>{let e=(0,r.I0)(),[t,l]=(0,a.useState)(null),[i,c]=(0,a.useState)(1);return(0,s.jsxs)("div",{className:"flex z-50 absolute w-[510px] h-[100vh] max-h-[100vh] bg-white",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center w-[110px] h-[100vh] max-h-[100vh] gap-[15px] py-[25px] border-r-2 border-gray-200",children:[(0,s.jsx)("div",{className:"w-[60px] h-[60px] rounded-md bg-yellow-100 ".concat(1===i?"bg-yellow-300":""),onClick:()=>{c(1)}}),(0,s.jsx)("div",{className:"w-[60px] h-[60px] rounded-md bg-yellow-100 ".concat(2===i?"bg-yellow-300":""),onClick:()=>{c(2)}}),(0,s.jsx)("div",{className:"w-[60px] h-[60px] rounded-md bg-yellow-100 ".concat(3===i?"bg-yellow-300":""),onClick:()=>{c(3)}})]}),(0,s.jsxs)("div",{className:"w-[400px] h-[100vh] max-h-[100vh] bg-white p-[25px]",children:[(0,s.jsx)("div",{children:(0,s.jsx)(n.F2,{onLoad:e=>l(e),onPlaceChanged:()=>{var l;let s=null==t?void 0:t.getPlace();(null==s?void 0:null===(l=s.geometry)||void 0===l?void 0:l.location)&&e(o({lat:s.geometry.location.lat(),lng:s.geometry.location.lng()}))},children:(0,s.jsx)("input",{type:"text",placeholder:"Поиск",className:"px-[15px] w-[100%] h-[40px] border-[1px] border-gray-200"})})}),1===i&&(0,s.jsx)(w,{}),2===i&&(0,s.jsx)(E,{}),3===i&&(0,s.jsx)(R,{})]})]})};var D=l(2633),O={src:"/_next/static/media/OtherIcon.71216d7a.svg",height:201,width:200,blurWidth:0,blurHeight:0};let M=e=>{(0,r.v9)(e=>e.type.type);let[t,l]=(0,a.useState)(!1),[n,i]=(0,D.Rt)(),[c,o]=(0,a.useState)(e.type);return(0,a.useEffect)(()=>{o(e.type)},[e.type]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D._Q,{ref:n,onClick:()=>{l(!0),e.onClick&&e.onClick()},position:e.position,title:e.place.name,children:(0,s.jsx)("img",{src:(e=>{let t=j.find(t=>t.type===e);return t?t.icon:O})(e.place.types.includes(c)?c:e.place.types[0]).src,className:"w-[32px] h-[32px]"})}),t&&(0,s.jsx)(D.nx,{anchor:i,maxWidth:200,onCloseClick:()=>l(!1),children:(0,s.jsxs)("div",{className:"gap-[10px]",children:[(0,s.jsx)("h1",{className:"font-bold",children:e.place.name}),(0,s.jsx)("img",{className:"object-cover w-24 h-24 overflow-hidden rounded-lg",src:e.place.photos&&e.place.photos.length>0?e.place.photos[0].getUrl():y,alt:e.place.name||"Place Image"}),(0,s.jsx)("p",{children:e.place.vicinity})]})})]})},H=(0,a.forwardRef)((e,t)=>{let l=function(e){var t;let{onClick:l,onDrag:s,onDragStart:r,onDragEnd:n,onMouseOver:i,onMouseOut:c,onRadiusChanged:o,onCenterChanged:d,radius:u,center:p,...h}=e,x=(0,a.useRef)({});Object.assign(x.current,{onClick:l,onDrag:s,onDragStart:r,onDragEnd:n,onMouseOver:i,onMouseOut:c,onRadiusChanged:o,onCenterChanged:d});let g=(0,a.useRef)(new google.maps.Circle).current;g.setOptions(h),(0,a.useEffect)(()=>{p&&!(0,D.hR)(p,g.getCenter())&&g.setCenter(p)},[p]),(0,a.useEffect)(()=>{null!=u&&u!==g.getRadius()&&g.setRadius(u)},[u]);let m=null===(t=(0,a.useContext)(D._Z))||void 0===t?void 0:t.map;return(0,a.useEffect)(()=>{if(!m){void 0===m&&console.error("<Circle> has to be inside a Map component.");return}return g.setMap(m),()=>{g.setMap(null)}},[m]),(0,a.useEffect)(()=>{if(!g)return;let e=google.maps.event;return[["click","onClick"],["drag","onDrag"],["dragstart","onDragStart"],["dragend","onDragEnd"],["mouseover","onMouseOver"],["mouseout","onMouseOut"]].forEach(t=>{let[l,s]=t;e.addListener(g,l,e=>{let t=x.current[s];t&&t(e)})}),e.addListener(g,"radius_changed",()=>{var e,t;let l=g.getRadius();null===(e=(t=x.current).onRadiusChanged)||void 0===e||e.call(t,l)}),e.addListener(g,"center_changed",()=>{var e,t;let l=g.getCenter();null===(e=(t=x.current).onCenterChanged)||void 0===e||e.call(t,l)}),()=>{e.clearInstanceListeners(g)}},[g]),g}(e);return(0,a.useImperativeHandle)(t,()=>l),null});H.displayName="Circle";let W=(0,i.oM)({name:"places",initialState:{places:[]},reducers:{setPlaces(e,t){e.places=t.payload},clearPlaces(e,t){e.places=[]}}}),{setPlaces:z,clearPlaces:L}=W.actions;var T=W.reducer;let A=(e,t,l)=>{let s=(0,r.I0)();(0,a.useEffect)(()=>{let a=new google.maps.places.PlacesService(document.createElement("div"));a.nearbySearch({location:e,radius:t,type:l,language:"RU"},(e,t,l)=>{t===google.maps.places.PlacesServiceStatus.OK&&e?Promise.all(e.map(e=>e.place_id?new Promise((t,l)=>{a.getDetails({placeId:e.place_id},(s,a)=>{a===google.maps.places.PlacesServiceStatus.OK&&s?t({...e,isOpen:s.opening_hours?s.opening_hours.isOpen():null,business_status:s.business_status||e.business_status||""}):l("Failed to get details for place ID: ".concat(e.place_id,", status: ").concat(a))})}):Promise.reject("Place ID is undefined for place: ".concat(e.name)))).then(e=>{s(z(e)),console.log(e)}).catch(e=>{console.error("Error fetching place details:",e)}):(console.error("Some error:",t),t===google.maps.places.PlacesServiceStatus.ZERO_RESULTS&&s(L([])))})},[e,t,l,s])},U=()=>{let e=(0,r.I0)(),[t,l]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{navigator.geolocation.getCurrentPosition(t=>{let{coords:{latitude:s,longitude:a}}=t;e(o({lat:s,lng:a})),l(!1)},e=>{console.error("Error getting location: ",e)})},[e]),t};function F(e){var t,l;let{origin:r,destination:n}=e,i=(0,D.Sx)(),c=(0,D.kY)("routes"),[o,d]=(0,a.useState)(null),[u,p]=(0,a.useState)(null),[h,x]=(0,a.useState)([]),[g,m]=(0,a.useState)(0),f=h[g],v=null==f?void 0:f.legs[0];return((0,a.useEffect)(()=>{if(!c||!i)return;let e=new c.DirectionsService,t=new c.DirectionsRenderer({map:i});return d(e),p(t),()=>{t.setMap(null)}},[c,i]),(0,a.useEffect)(()=>{o&&u&&o.route({origin:r,destination:n,travelMode:google.maps.TravelMode.DRIVING,provideRouteAlternatives:!0}).then(e=>{u.setDirections(e),x(e.routes)}).catch(e=>{console.error("Error fetching directions",e)})},[o,u,r,n]),(0,a.useEffect)(()=>{u&&u.setRouteIndex(g)},[g,u]),v)?(0,s.jsxs)("div",{className:"directions",children:[(0,s.jsx)("h2",{children:f.summary}),(0,s.jsxs)("p",{children:[v.start_address.split(",")[0]," to ",v.end_address.split(",")[0]]}),(0,s.jsxs)("p",{children:["Distance: ",null===(t=v.distance)||void 0===t?void 0:t.text]}),(0,s.jsxs)("p",{children:["Duration: ",null===(l=v.duration)||void 0===l?void 0:l.text]}),(0,s.jsx)("h2",{children:"Other Routes"}),(0,s.jsx)("ul",{children:h.map((e,t)=>(0,s.jsx)("li",{children:(0,s.jsx)("button",{onClick:()=>m(t),children:e.summary})},e.summary))})]}):null}let Z=e=>{let t;return{strokeColor:t=e<=1e3?"#b6d7a8":e<=2e3?"#ffe599":"#ea9999",fillColor:t}},K=()=>{(0,r.I0)();let e=(0,r.v9)(e=>e.range.range),t=(0,r.v9)(e=>e.type.type),l=(0,r.v9)(e=>e.currentCoordinates.currentCoordinates),n=(0,r.v9)(e=>e.places.places),[i,c]=(0,a.useState)(null);A(l,e,t);let o=U(),{strokeColor:d,fillColor:u}=Z(e);return o?(0,s.jsx)("div",{children:"Map is loading..."}):(0,s.jsx)("div",{children:(0,s.jsx)(D.un,{apiKey:"AIzaSyBSW-4EL24kJ0gz6tfTEm5SnyRI3BRw38c",children:(0,s.jsxs)(D.D5,{mapId:"8e12ae327d911b88",style:{width:"100vw",height:"100vh"},defaultCenter:l,defaultZoom:13,disableDefaultUI:!0,onClick:()=>{c(null)},reuseMaps:!0,children:[(0,s.jsx)(H,{radius:e,center:l,strokeColor:d,fillColor:u,onClick:()=>{c(null)}}),(0,s.jsx)(D._Q,{position:l}),n.map((e,l)=>{let a={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};return(0,s.jsx)(M,{position:a,place:e,type:t,onClick:()=>{console.log("Place clicked:",a),c(a)}},l)}),i&&(0,s.jsx)(F,{origin:l,destination:i})]},l.lat+l.lng)})})},B=()=>(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(P,{}),(0,s.jsx)(K,{})]}),Q=(0,i.xC)({reducer:{places:T,currentCoordinates:d,type:_,range:I},middleware:e=>e({serializableCheck:!1})});function G(e){let{children:t}=e;return(0,s.jsx)(r.zt,{store:Q,children:t})}function J(){return(0,s.jsx)(G,{children:(0,s.jsx)(B,{})})}},7312:function(e,t,l){"use strict";l.r(t),t.default={src:"/_next/static/media/Architecture1Icon.e40a5490.svg",height:201,width:200,blurWidth:0,blurHeight:0}},9550:function(e,t,l){"use strict";l.r(t),t.default={src:"/_next/static/media/CultureIcon.fde9e53d.svg",height:200,width:200,blurWidth:0,blurHeight:0}},1881:function(e,t,l){"use strict";l.r(t),t.default={src:"/_next/static/media/FoodIcon.e67dd7c5.svg",height:200,width:200,blurWidth:0,blurHeight:0}},2202:function(e,t,l){"use strict";l.r(t),t.default={src:"/_next/static/media/HistoryIcon.487dc781.svg",height:200,width:200,blurWidth:0,blurHeight:0}},5367:function(e,t,l){"use strict";l.r(t),t.default={src:"/_next/static/media/Hotel1Icon.093cc466.svg",height:200,width:200,blurWidth:0,blurHeight:0}},6502:function(e,t,l){"use strict";l.r(t),t.default={src:"/_next/static/media/NatureIcon.0d37f821.svg",height:200,width:200,blurWidth:0,blurHeight:0}},6525:function(e,t,l){"use strict";l.r(t),t.default={src:"/_next/static/media/Religion1Icon.4a2c3811.svg",height:200,width:200,blurWidth:0,blurHeight:0}}},function(e){e.O(0,[706,910,846,971,23,744],function(){return e(e.s=4597)}),_N_E=e.O()}]);